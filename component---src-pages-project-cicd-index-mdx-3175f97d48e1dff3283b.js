(window.webpackJsonp=window.webpackJsonp||[]).push([[59],{"013z":function(e,t,a){"use strict";a("KKXr"),a("pIFo");var i=a("pOBw"),n=a("q1tI"),r=a.n(n),l=a("NmYn"),o=a.n(l),c=a("OKom"),s=a("k4MR"),b=a("TSYQ"),p=a.n(b),m=a("QH2O"),u=a("qKvR"),g=function(e){var t,a=e.title,i=e.tabs,n=void 0===i?[]:i;return Object(u.b)("div",{className:p()(m.pageHeader,(t={},t[m.withTabs]=n.length,t))},Object(u.b)("div",{className:"bx--grid"},Object(u.b)("div",{className:"bx--row"},Object(u.b)("div",{className:"bx--col-lg-12"},Object(u.b)("h1",{id:"page-title",className:m.text},a)))))},h=a("pEPl"),d=a("BAC9"),O=function(e){var t=e.relativePagePath,a=e.repository,i=h.data.site.siteMetadata.repository,n=a||i,r=n.baseUrl,l=n.subDirectory,o=r+"/edit/"+n.branch+l+"/src/pages"+t;return r?Object(u.b)("div",{className:"bx--row "+d.row},Object(u.b)("div",{className:"bx--col"},Object(u.b)("a",{className:d.link,href:o},"Edit this page on GitHub"))):null},j=a("FCXl"),f=(a("Oyvg"),a("Wbzz")),N=a("I8xM");var y=function(e){var t,a;function i(){return e.apply(this,arguments)||this}return a=e,(t=i).prototype=Object.create(a.prototype),t.prototype.constructor=t,t.__proto__=a,i.prototype.render=function(){var e=this.props,t=e.tabs,a=e.slug,i=a.split("/").filter(Boolean).slice(-1)[0],n=t.map((function(e){var t,n=o()(e,{lower:!0}),r=n===i,l=new RegExp(i+"(?!-)"),c=a.replace(l,n);return Object(u.b)("li",{key:e,className:p()((t={},t[N.selectedItem]=r,t),N.listItem)},Object(u.b)(f.Link,{className:N.link,to:""+c},e))}));return Object(u.b)("div",{className:N.tabsContainer},Object(u.b)("div",{className:"bx--grid"},Object(u.b)("div",{className:"bx--row"},Object(u.b)("div",{className:"bx--col-lg-12 bx--col-no-gutter"},Object(u.b)("nav",null,Object(u.b)("ul",{className:N.list},n))))))},i}(r.a.Component),w=a("MjG9");t.a=function(e){var t=e.pageContext,a=e.children,n=e.location,r=e.Title,l=t.frontmatter,b=void 0===l?{}:l,p=t.relativePagePath,m=t.titleType,h=b.tabs,d=b.title,f=b.theme,N=b.description,v=b.keywords,A=i.data.site.pathPrefix,C=A?n.pathname.replace(A,""):n.pathname,T=h?C.split("/").slice(-1)[0]||o()(h[0],{lower:!0}):"";return Object(u.b)(s.a,{tabs:h,homepage:!1,theme:f,pageTitle:d,pageDescription:N,pageKeywords:v,titleType:m},Object(u.b)(g,{title:r?Object(u.b)(r,null):d,label:"label",tabs:h}),h&&Object(u.b)(y,{slug:C,tabs:h,currentTab:T}),Object(u.b)(w.a,{padded:!0},a,Object(u.b)(O,{relativePagePath:p})),Object(u.b)(j.a,{pageContext:t,location:n,slug:C,tabs:h,currentTab:T}),Object(u.b)(c.a,null))}},"9Yyi":function(e,t,a){"use strict";a.r(t),a.d(t,"_frontmatter",(function(){return l})),a.d(t,"default",(function(){return s}));a("91GP"),a("rGqo"),a("yt8O"),a("Btvt"),a("RW0V"),a("q1tI");var i=a("7ljp"),n=a("013z");a("qKvR");function r(){return(r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(e[i]=a[i])}return e}).apply(this,arguments)}var l={},o={_frontmatter:l},c=n.a;function s(e){var t=e.components,a=function(e,t){if(null==e)return{};var a,i,n={},r=Object.keys(e);for(i=0;i<r.length;i++)a=r[i],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,["components"]);return Object(i.b)(c,r({},o,a,{components:t,mdxType:"MDXLayout"}),Object(i.b)("h2",null,"Challenge"),Object(i.b)("p",null,"You are provided with the challenge to implement a demo that shows best practices for DevOps.\nImplement Continous Integration and Continous Deployment for an Application on Kubernetes."),Object(i.b)("p",null,"You are being provided with:"),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},"OpenShift 4"),Object(i.b)("li",{parentName:"ul"},"Git repository containing application source code"),Object(i.b)("li",{parentName:"ul"},"Git repository containing deployment manifests (ie. yamls)")),Object(i.b)("h2",null,"Specifications"),Object(i.b)("h3",null,"Access Cluster"),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},"Ask your instructors on how to gain access to OpenShift cluster"),Object(i.b)("li",{parentName:"ul"},"Create a new namespace to deploy the application ",Object(i.b)("inlineCode",{parentName:"li"},"project-cicd-${userid}"))),Object(i.b)("h3",null,"Code Repo"),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},"Git repository for Code is located ",Object(i.b)("a",r({parentName:"li"},{href:"https://github.com/ibm-cloud-architecture/cloudnative_sample_app"}),"https://github.com/ibm-cloud-architecture/cloudnative_sample_app")),Object(i.b)("li",{parentName:"ul"},"Create a new Git repository on your own public git account using the git repo as a template"),Object(i.b)("li",{parentName:"ul"},"Use the ",Object(i.b)("inlineCode",{parentName:"li"},"Dockerfile")," on the root of the repository to build an container image")),Object(i.b)("h3",null,"Infra Repo"),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},"Git repository for Manifets (ie Yamls) is located ",Object(i.b)("a",r({parentName:"li"},{href:"https://github.com/ibm-cloud-architecture/cloudnative_sample_app_deploy"}),"https://github.com/ibm-cloud-architecture/cloudnative_sample_app_deploy")),Object(i.b)("li",{parentName:"ul"},"Create a new Git repository on your own public git account using the git repo as a template"),Object(i.b)("li",{parentName:"ul"},"The directory ",Object(i.b)("inlineCode",{parentName:"li"},"yamls")," on the repository contains the deployment manifests to deploy the app")),Object(i.b)("h3",null,"Argocd"),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},"Argocd is already installed on the OpenShift cluster using an operator on the namespace ",Object(i.b)("inlineCode",{parentName:"li"},"argocd")),Object(i.b)("li",{parentName:"ul"},"To login into the Argocd use username ",Object(i.b)("inlineCode",{parentName:"li"},"admin")," and password the name of the argocd pod"),Object(i.b)("li",{parentName:"ul"},"Ge the ArgoCD UI URL with the following command",Object(i.b)("pre",{parentName:"li"},Object(i.b)("code",r({parentName:"pre"},{className:"language-bash"}),'export ARGOCD_URL="https://$(oc get route argocd-server -n argocd -o jsonpath=\'{.spec.host}\')"\necho "ARGOCD URL=$ARGOCD_URL"\nopen "$ARGOCD_URL"\n'))),Object(i.b)("li",{parentName:"ul"},"Deploy the application on the new namespace using infra git repositoryurl and configure with autosync when every time there is a change in the Infra repo.")),Object(i.b)("h3",null,"Tekton"),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},"Tekton is already installed on the OpenShift cluster using an operator"),Object(i.b)("li",{parentName:"ul"},"The service account to use to run the pipelines is ",Object(i.b)("inlineCode",{parentName:"li"},"pipeline")," it automatically gets created on every new namespace"),Object(i.b)("li",{parentName:"ul"},"Use the following guide to create a Pipeline, Tasks, and secret:\n",Object(i.b)("span",r({parentName:"li"},{className:"gatsby-resp-image-wrapper",style:{position:"relative",display:"block",marginLeft:"auto",marginRight:"auto",maxWidth:"121px"}}),"\n      ",Object(i.b)("span",r({parentName:"span"},{className:"gatsby-resp-image-background-image",style:{paddingBottom:"538.0165289256198%",position:"relative",bottom:"0",left:"0",backgroundImage:"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAABsCAYAAABq+JKhAAAACXBIWXMAAAsSAAALEgHS3X78AAAI3UlEQVRo3r1aaWwUyRmd8XiVZcHeRRwyEI6AbWyWS0YiibKJEiJFQawEMj8W+MEPFtAGVsqKDRKHA+awuUEgbgTGGMx9GDA3WJzmENeaw9xGYHNjc/oYeyrv1bpG1T3dPQ2MUtJzd1e/qf76+F69qrInLy9P3Lx5UxQVFYkrV658MjxsLJLFw8hY/H6/qKurCyJc0bk6PAxTEQKBgATL7du3xaZNm8TFixfF6dOnxc6dO8WBAwfE3r17RXFxseTo/GCEdg3m5+eLrKwscePGDXHy5EmxY8cOsW/fPrFlyxZ5rP/GtkF1VZYXL16I+/fviydPnoinT5+Kt2/fikePHolnz56J2tpaA9cxQtXwnTt3xIwZM0RGRoZYtGiROHPmjJg3b57gV/Hw4UPHW2ZNAFcN6IXH5eXlgdLS0gCiCuBCgerq6gBensSv7YUWD59RRD8bvMGqysrKKkRTVVFREQLW16Pa6rwZnvbt23/dqVOnr5OTky3RuXPnpHbt2vWMi4v7Z7du3RKTkpI623EJj8vyG6CNK+bQoUN9aWlpvjFjxvjGjh1rwKhRo3x4LN6uXbs2iImJaUv+wIEDo808HW4j/APQ1xUzNTU1btiwYXFDhgwJwaBBg1ripTXC8/u+WbNm/7506VJDRNjKiqvg2bNnjx8Z4Yfq+G/dumVGDeprcf5tSUnJOxuOAR78ibh8BTOF2WAG61V22HF0hIiDXqyS36rOUW3Uj9TxhQsXxJEjR8TRo0fF1atXbWXLdYNUmblz54rVq1cLszK5btDNLds2iJfClurwwOtA+mRE/rM5ceJE+evXr8sh8+UQ0hA8f/6c2wp0Ba+w/9KKo8NTryJ2oCC0AihLfwFaAO3C/CbC8pWYmOiFcHq7dOlCmTIgPj4+ipzo6OgvvV5vAvdbtGgRZebpcBthLNChft/5Rxs2bPDBHfggUz58xAYUFBRIgU1JSYlt0qRJIvn4wKOtuApuI6S4DnHFnD179ritW7eOW79+/ThEawDqxqNj/09mZuby9PT0bPibn3Nzc9PMPB0emqKIfthQEBoV2ga5tYCfqVkPvw0niKAVoTjqhXUwAIGysrJATU2NtCQPHjxwtCHSitjJFwtSTcyaNUusWrVKrFixQpqn9+/f2xolWzuniKyjhaPbgs2Qti6ccjs2uH//fmnf6Fq3b98uHe358+c/PsLLly+La9euCXS1Yvny5RKK79Qg35wfAusHwYD6t+o3vfEQng4PbW9Ev8OVK1fmHDt2LOfgwYM5hw8fNuDQoUM56PGy8Qw3bNu2bQdyezXrzDwdbnM5ql5cwxdEGeUEcqCXXzVt2lSqDZXJkT9ixAjP5MmTPRMmTPBMnDgxCHhGT4MGDdR1vwSkwPp8Pi+8pIGrI1xRYvo50Fq7/U8rzZs3T4qNjf2rW/7nDviinvM9MKp+/wvH32D8VgQVKYIuFmH0ZIm7d+/+gvNXuLXjKET+w4a3kWnFgnw2QEs5JbBSiM08HY7iwBEo1eX69evi+PHjcnhrxXPlD1keP34skJoiJydHZGdni927dzsObcPKF16WuHfvnlRpRgtTJbcfrYcUV47gFyxYIGbOnCmmTp0qICKOLtZ2FMDy6tWrAKKT4+Vz584FkMcBRCjP2Y4CMF6uDdc1fgg4XhboLgXGwwIRGcCOieA5BR6beTqoKt8sW7bsm4ULF1oC3ecfoUT/GD58+Hd407/H8/yzHZdwm+9UnThXzDlz5kRB3qNgdKLQTQaxcePGKFxR2rM2bdp81ahRIymwo0ePjuY5navjQwxnvCvDiVGSD524D1f14QoGwFxKw9mzZ8+GjRs3/h35kyZNijbzdLiN8O/AAFfMKVOm9FmzZk0f5GwfmCID4BS+3bVrV6/Bgwf/d8CAAZlwEH9jnZmng72YTBl+i9XV1QZUVVVJqH3zeSt4iouLdcthhRotE2rCcP3BCUnKkhrWqqRXV+UxIzRPSCoh0WE5f0hgDChg6AVsipyMRDZJbeRMHeus5hwtp/tU4cCbE4/M35KSEjnpy5Er52x5bGc8gw0qJaZL5ZRAYWGhbJDiwW7g7NmzcoqAXhFSJruEly9fhjQa0iAj2Lx5s5T86dOnC3w2Aqkp5xw4/0Cxpeemo6VdNncfIb2eeqN4GbVw/Jaapw9BQno99hsR7ZdxS4Xo8QvhpQvRXQbBYwLf6Sk8lrNIgIvYP6nqda4OpR52iDLbOTq6ML8JX/r37x/Ttm3bDvUG9ZOcnFfTwwRX/tDOwUKFPB06/DqI93q9DbGRegjl9k6bNs3ewVJAHSCjadmyZSsYzhTNk9v+xu2tDwJGumLCCOUhvfKQ8HlIpxAg/bZjzHcgPz//CNJxmx1P4f9jOM3mUzv2W5lMpqKC43Sf22KpNqxkv0J/wvx+8+aNlCflZegRubbC9RT6xHfv3sk1Fyq63miwQRbqHLyOVGrOllCm0tPT5dQANZGKDTch5s+fL5V7/PjxQnVy6g5DIqTAMrqamhrpVhklI2QkjIrnOBfBi/OFmleKDAs03H4MDLMikKLIGk61pBax7zAjI2Pk2rVrR2ZlZY2EOTIAdT8ik/6FF/BzZmZm+rp1637Ai/rRzNPxQYNSV6wlS5b4MFTwIVd96CINQHTRvIuOHTvCzTXuSD6k6zMzT4fb6PQuwFmievXq5U1NTfX27dvX269fPwN69+6t9PAzlN9yv3v37j4zT4fbCP/ExSFXTBjy5ISEhOT4+PgQcIkuJSWldUxMzE+Q/rQePXq0Zp0VV4EDn0okfiVSrBJCEAIuEiIly4EK7FtydER+KdNqsZWDQJWn+r5d/jrOcKotR/GLFy+Wlo7mk+6Lw92lS5fKKUCrNWlHw3nq1Cm5As7ZzYKCAulaOVamX6TIujac1D5GQMdK4aBrJbiAXVpaKiPnPs0ntTGs4WQjap6BhhNjQDlVyulT3j5GUtJv5+bmBlfCzYbT8G8JVGpuy8rKZETcZ3+i+g7usy8hn0GE/FtCxP9xQv/XDj4Xwu7fNsznFF/H/wDk1dz/g97fKwAAAABJRU5ErkJggg==')",backgroundSize:"cover",display:"block"}})),"\n  ",Object(i.b)("img",r({parentName:"span"},{className:"gatsby-resp-image-image",alt:"Tekton Pipeline",title:"Tekton Pipeline",src:"/learning-cloudnative-101/static/0bc850316dd3db40f73696f24db9da46/d15f4/tekton-pipeline.png",srcSet:["/learning-cloudnative-101/static/0bc850316dd3db40f73696f24db9da46/d15f4/tekton-pipeline.png 121w"],sizes:"(max-width: 121px) 100vw, 121px",style:{width:"100%",height:"100%",margin:"0",verticalAlign:"middle",position:"absolute",top:"0",left:"0"},loading:"lazy"})),"\n    "),Object(i.b)("ul",{parentName:"li"},Object(i.b)("li",{parentName:"ul"},"Create a pipeline, tasks, secrets on the target namespace"),Object(i.b)("li",{parentName:"ul"},"Git clone the source code from the App repo"),Object(i.b)("li",{parentName:"ul"},"Build a container image using the ",Object(i.b)("inlineCode",{parentName:"li"},"Dockerfile")," on the repo"),Object(i.b)("li",{parentName:"ul"},"Tag the image using the 7 first characters of the git hash corresponding to last git commit"),Object(i.b)("li",{parentName:"ul"},"Push the container image into the internal image registry on the same namespace"),Object(i.b)("li",{parentName:"ul"},"Git clone the Infra git repo"),Object(i.b)("li",{parentName:"ul"},"Update the image on the deployment yaml with the new image id that has the tag with value of the git commit"),Object(i.b)("li",{parentName:"ul"},"Git commit the changes"),Object(i.b)("li",{parentName:"ul"},"Git push the changes to the infra git repo, this should trigger argocd to pickup any changes from the infra repo.")))),Object(i.b)("h2",null,"Hints"),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},"Use ",Object(i.b)("a",r({parentName:"li"},{href:"/learning-cloudnative-101/yamls/project-cicd/task-git-push.yaml"}),"task-git-push.yaml")," as an example of Tekton steps to git clone, edit yaml files, and git push"),Object(i.b)("li",{parentName:"ul"},"Use ",Object(i.b)("a",r({parentName:"li"},{href:"/learning-cloudnative-101/yamls/project-cicd/git-infra-secret.yaml"}),"git-infra-secret.yaml")," as an example of Kubernetes secret being reference by the ",Object(i.b)("inlineCode",{parentName:"li"},"git-push")," task"),Object(i.b)("li",{parentName:"ul"},"The secret contains the git username and token with permission ",Object(i.b)("inlineCode",{parentName:"li"},"repo")," that gives write access to repository"),Object(i.b)("li",{parentName:"ul"},"OpenShift 4 comes with an internal image registry you can push from a Tekton task"),Object(i.b)("li",{parentName:"ul"},"The image registry url contains the service name, port, namespace, image name and tag",Object(i.b)("pre",{parentName:"li"},Object(i.b)("code",r({parentName:"pre"},{}),"image-registry.openshift-image-registry.svc:5000/my-namespace-app/image-name:my-tag\n"))),Object(i.b)("li",{parentName:"ul"},"The image registry only handles ssl/https connections, but it uses a self sign certificate"),Object(i.b)("li",{parentName:"ul"},"You need to ignore TLS-Verify to be able to succesfully push and ignore ssl errors for example using buildah set the flag ",Object(i.b)("inlineCode",{parentName:"li"},'--tls-verify="false"'))),Object(i.b)("h2",null,"Extra Credit"),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},"Make the pipeline to run automatically every time new code gets pushed to the Code git repository",Object(i.b)("ul",{parentName:"li"},Object(i.b)("li",{parentName:"ul"},"Configure a Github Webhook using the new ",Object(i.b)("a",r({parentName:"li"},{href:"https://github.com/tektoncd/triggers"}),"Tekton Triggers")," listener and bindings"),Object(i.b)("li",{parentName:"ul"},"You can use the Tekton Getting Started as guide on how to implement the Webhook"),Object(i.b)("li",{parentName:"ul"},Object(i.b)("a",r({parentName:"li"},{href:"https://github.com/tektoncd/triggers/blob/master/docs/install.md"}),"Install")," Triggers, check out the\n",Object(i.b)("a",r({parentName:"li"},{href:"https://github.com/tektoncd/triggers/blob/master/docs/install.md"}),"installation guide"),", ",Object(i.b)("a",r({parentName:"li"},{href:"https://github.com/tektoncd/triggers/blob/master/examples/README.md"}),"examples")," or\nfollow the ",Object(i.b)("a",r({parentName:"li"},{href:"https://github.com/tektoncd/triggers/blob/master/docs/getting-started/README.md"}),"getting started guide")," to become\nfamiliar with the project. The getting started guide walks through setting up an\nend-to-end image building solution, which will be triggered from GitHub ",Object(i.b)("inlineCode",{parentName:"li"},"push"),"\nevents.")))))}s.isMDXComponent=!0},pEPl:function(e){e.exports=JSON.parse('{"data":{"site":{"id":"Site","siteMetadata":{"repository":{"baseUrl":"https://github.com/ibm-cloud-architecture/learning-cloudnative-101","subDirectory":"/","branch":"master"}}}}}')},pOBw:function(e){e.exports=JSON.parse('{"data":{"site":{"id":"Site","pathPrefix":"/learning-cloudnative-101"}}}')}}]);
//# sourceMappingURL=component---src-pages-project-cicd-index-mdx-3175f97d48e1dff3283b.js.map